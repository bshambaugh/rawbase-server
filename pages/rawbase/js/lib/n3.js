!function(e){function t(){if(!(this instanceof t))return new t;for(var e in s)this[e]=s[e]}function i(e){return this instanceof i?(this._size=0,this._contexts=Object.create(null),this._entities=Object.create(null),this._entities[">>____unused_item_to_make_first_entity_key_non-falsy____<<"]=0,this._entityCount=0,this._blankNodeIndex=0,e&&this.addTriples(e),void 0):new i(e)}function u(e){return this instanceof u?(e=e||{},this._lexer=e.lexer||new t,this._blankNodes=Object.create(null),this._blankNodeCount=0,this._tripleStack=[],e.documentURI?(this._baseURI=this._documentURI=e.documentURI,this._baseURIRoot=this._documentURIRoot=e.documentURI.replace(x,"")):(this._baseURI=this._documentURI=null,this._baseURIROOT=this._documentURIRoot=null),void 0):new u(e)}var s={_explicituri:/^<((?:[^\x00-\x20<>\\"\{\}\|\^\`]|\\[uU])*)>/,_string:/^"[^"\\]*(?:\\.[^"\\]*)*"(?=[^"\\])|^'[^'\\]*(?:\\.[^'\\]*)*'(?=[^'\\])/,_tripleQuotedString:/^""("[^"\\]*(?:(?:\\.|"(?!""))[^"\\]*)*")""|^''('[^'\\]*(?:(?:\\.|'(?!''))[^'\\]*)*')''/,_langcode:/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,_prefix:/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\.\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=\s)/,_qname:/^((?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\.\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?=[\s\.;,)#])/,_number:/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d+\.\d+|\.\d+|\d+)(?=\s*[\s\.;,)#])/,_boolean:/^(?:true|false)(?=[\s#,;.])/,_punctuation:/^\.(?!\d)|^;|^,|^\[|^\]|^\(|^\)/,_fastString:/^"[^"\\]+"(?=[^"\\])/,_keyword:/^(?:@[a-z]+|[Pp][Rr][Ee][Ff][Ii][Xx]|[Bb][Aa][Ss][Ee])(?=\s)/,_type:/^\^\^(?:<([^>]*)>|([A-Z_a-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd][\-0-9A-Z_a-z\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]*)?:([A-Z_a-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd][\-0-9A-Z_a-z\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]*)(?=[\s\.;,)#]))/,_shortPredicates:/^a(?=\s+|<)/,_newline:/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,_whitespace:/^[ \t]+/,_nonwhitespace:/^\S*/,_endOfFile:/^(?:#[^\n\r]*)?$/},r=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,n={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"	",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},a=/[\x00-\x20<>\\"\{\}\|\^\`]/,f={".":"dot",";":"semicolon",",":"comma","[":"bracketopen","]":"bracketclose","(":"liststart",")":"listend"},c={a:"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"};t.prototype={_next:function(e){function t(t){return i=t._nonwhitespace.exec(t._input),delete t._input,e('Syntax error: unexpected "'+i[0]+'" on line '+t._line+"."),!1}if(void 0===this._input)return!1;for(var i;i=this._newline.exec(this._input);)this._line++,this._input=this._input.substr(i[0].length);(i=this._whitespace.exec(this._input))&&(this._input=this._input.substr(i[0].length));var u,s={line:this._line,type:"",value:"",prefix:""};if(this._endOfFile.test(this._input))return this._inputComplete?(delete this._input,s.type="eof",e(null,s),!0):!1;if(i=this._explicituri.exec(this._input)){if(u=this._unescape(i[1]),null===u||a.test(u))return t(this);s.type="explicituri",s.value=u}else if(i=this._punctuation.exec(this._input))s.type=f[i[0]];else if("literal"===this._prevTokenType&&(i=this._langcode.exec(this._input)))s.type="langcode",s.value=i[1];else if(i=this._fastString.exec(this._input))s.type="literal",s.value=i[0];else if(i=this._string.exec(this._input)){if(u=this._unescape(i[0]),null===u)return t(this);s.type="literal",s.value=u.replace(/^'|'$/g,'"')}else if(i=this._tripleQuotedString.exec(this._input)){if(u=i[1]||i[2],this._line+=u.split(/\r\n|\r|\n/).length-1,u=this._unescape(u),null===u)return t(this);s.type="literal",s.value=u.replace(/^'|'$/g,'"')}else if(i=this._number.exec(this._input))s.type="literal",s.value='"'+i[0]+'"^^<http://www.w3.org/2001/XMLSchema#'+(i[1]?"double>":/^[+\-]?\d+$/.test(i[0])?"integer>":"decimal>");else if(i=this._boolean.exec(this._input))s.type="literal",s.value='"'+i[0]+'"^^<http://www.w3.org/2001/XMLSchema#boolean>';else if("literal"===this._prevTokenType&&(i=this._type.exec(this._input)))s.type="type",i[2]?(s.prefix=i[2],s.value=i[3]):s.value=i[1];else if(i=this._keyword.exec(this._input)){var r=i[0];s.type="@"===r[0]?r:r.toUpperCase()}else if("@prefix"!==this._prevTokenType&&"PREFIX"!==this._prevTokenType||!(i=this._prefix.exec(this._input)))if(i=this._qname.exec(this._input)){if(u=this._unescape(i[2]),null===u)return t(this);s.type="qname",s.prefix=i[1]||"",s.value=u}else{if(!(i=this._shortPredicates.exec(this._input)))return this._inputComplete&&t(this),!1;s.type="abbreviation",s.value=c[i[0]]}else s.type="prefix",s.value=i[1]||"";return this._prevTokenType=s.type,this._input=this._input.substr(i[0].length),e(null,s),!0},_unescape:function(e){try{return e.replace(r,function(e,t,i,u){var s;if(t){if(s=parseInt(t,16),isNaN(s))throw"invalid character code";return String.fromCharCode(s)}if(i){if(s=parseInt(i,16),isNaN(s))throw"invalid character code";return 65535>s?String.fromCharCode(s):String.fromCharCode(Math.floor((s-65536)/1024)+55296)+String.fromCharCode((s-65536)%1024+56320)}var r=n[u];if(!r)throw"invalid escape sequence";return r})}catch(t){return null}},tokenize:function(e,t){var i=this;this._line=1,"string"==typeof e?(this._input=e,this._inputComplete=!0,window.setTimeout(function(){for(;i._next(t););})):(this._input="",this._inputComplete=!1,e.setEncoding("utf8"),e.on("data",function(e){for(i._input+=e;i._next(t););}),e.on("end",function(){for(i._inputComplete=!0;i._next(t););}))}},i.prototype={get defaultContext(){return"n3/contexts#default"},get size(){var e=this._size;if(null!==e)return e;var t,i,u=this._contexts;for(var s in u)for(var r in t=u[s].subjects)for(var n in i=t[r])e+=Object.keys(i[n]).length;return this._size=e},_addToIndex:function(e,t,i,u){var s=e[t]||(e[t]={}),r=s[i]||(s[i]={});r[u]=null},_findInIndex:function(e,t,i,u,s,r,n,a){var f,c=[],d=Object.keys(this._entities);t&&(f=e)&&((e={})[t]=f[t]);for(var l in e){var _=e[l]||{},o=d[l];i&&(f=_)&&((_={})[i]=f[i]);for(var h in _){var p=_[h]||{},b=d[h];u&&(f=p)&&(u in p?(p={})[u]=f[u]:p={}),c.push.apply(c,Object.keys(p).map(function(e){var t={context:a};return t[s]=o,t[r]=b,t[n]=d[e],t}))}}return c},add:function(e,t,i,u){u=u||this.defaultContext;var s=this._contexts[u];s||(s=this._contexts[u]={subjects:{},predicates:{},objects:{}},Object.freeze(s));var r=this._entities;return e=r[e]||(r[e]=++this._entityCount),t=r[t]||(r[t]=++this._entityCount),i=r[i]||(r[i]=++this._entityCount),this._addToIndex(s.subjects,e,t,i),this._addToIndex(s.predicates,t,i,e),this._addToIndex(s.objects,i,e,t),this._size=null,this},addTriple:function(e){return this.add(e.subject,e.predicate,e.object,e.context)},addTriples:function(e){for(var t=e.length-1;t>=0;t--)this.addTriple(e[t]);return this},find:function(e,t,i,u){u=u||this.defaultContext;var s=this._contexts[u],r=this._entities;return e&&!(e=r[e])?[]:t&&!(t=r[t])?[]:i&&!(i=r[i])?[]:s?e?i?this._findInIndex(s.objects,i,e,t,"object","subject","predicate",u):this._findInIndex(s.subjects,e,t,i,"subject","predicate","object",u):t?this._findInIndex(s.predicates,t,i,e,"predicate","object","subject",u):this._findInIndex(s.objects,i,e,t,"object","subject","predicate",u):[]},createBlankNode:function(e){var t;if(e){t=e="_:"+e;for(var i=1;this._entities[t];)t=e+i++}else do t="_:b"+this._blankNodeIndex++;while(this._entities[t]);return this._entities[t]=this._entityCount++,t}};var d,l="http://www.w3.org/1999/02/22-rdf-syntax-ns#",_=l+"nil",o=l+"first",h=l+"rest",p=/^[a-z]+:/,b=/^#/,x=/[^\/]*$/;u.prototype={_readInTopContext:function(e){switch(e.type){case"eof":return this._callback(null,null);case"@prefix":return this._sparqlStyle=!1,this._readPrefix;case"PREFIX":return this._sparqlStyle=!0,this._readPrefix;case"@base":return this._sparqlStyle=!1,this._readBaseURI;case"BASE":return this._sparqlStyle=!0,this._readBaseURI;default:return this._readSubject(e)}},_readSubject:function(e){switch(e.type){case"explicituri":this._subject=null===this._baseURI||p.test(e.value)?e.value:(b.test(e.value)?this._baseURI:this._baseURIRoot)+e.value;break;case"qname":if("_"===e.prefix)this._subject=this._blankNodes[e.value]||(this._blankNodes[e.value]="_:b"+this._blankNodeCount++);else{var t=this._prefixes[e.prefix];if(t===d)return this._error('Undefined prefix "'+e.prefix+':"',e);this._subject=t+e.value}break;case"bracketopen":return this._subject="_:b"+this._blankNodeCount++,this._tripleStack.push({subject:this._subject,predicate:null,object:null,type:"blank"}),this._readBlankNodeHead;case"liststart":return this._tripleStack.push({subject:_,predicate:null,object:null,type:"list"}),this._subject=null,this._readListItem;default:return this._error('Unexpected token type "'+e.type,e)}return this._subjectHasPredicate=!1,this._readPredicate},_readPredicate:function(e){switch(e.type){case"explicituri":case"abbreviation":this._predicate=null===this._baseURI||p.test(e.value)?e.value:(b.test(e.value)?this._baseURI:this._baseURIRoot)+e.value;break;case"qname":if("_"===e.prefix)return this._error("Disallowed blank node as predicate",e);var t=this._prefixes[e.prefix];if(t===d)return this._error('Undefined prefix "'+e.prefix+':"',e);this._predicate=t+e.value;break;case"bracketclose":return this._readBlankNodeTail(e,!0);case"dot":return this._subjectHasPredicate?this._readPunctuation(e,!0):this._error("Unexpected dot",e);case"semicolon":return this._readPredicate;default:return this._error('Expected predicate to follow "'+this._subject+'"',e)}return this._subjectHasPredicate=!0,this._readObject},_readObject:function(e){switch(e.type){case"explicituri":this._object=null===this._baseURI||p.test(e.value)?e.value:(b.test(e.value)?this._baseURI:this._baseURIRoot)+e.value;break;case"qname":if("_"===e.prefix)this._object=this._blankNodes[e.value]||(this._blankNodes[e.value]="_:b"+this._blankNodeCount++);else{var t=this._prefixes[e.prefix];if(t===d)return this._error('Undefined prefix "'+e.prefix+':"',e);this._object=t+e.value}break;case"literal":return this._object=e.value,this._readDataTypeOrLang;case"bracketopen":var i="_:b"+this._blankNodeCount++;return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:i,type:"blank"}),this._subject=i,this._readBlankNodeHead;case"liststart":return this._tripleStack.push({subject:this._subject,predicate:this._predicate,object:_,type:"list"}),this._subject=null,this._readListItem;default:return this._error('Expected object to follow "'+this._predicate+'"',e)}return this._getTripleEndReader()},_readBlankNodeHead:function(e){return"bracketclose"===e.type?this._readBlankNodeTail(e,!0):this._readPredicate(e)},_readBlankNodeTail:function(e,t){if("bracketclose"!==e.type)return this._readPunctuation(e);t!==!0&&this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,context:"n3/contexts#default"});var i=this._tripleStack.pop();return this._subject=i.subject,null!==i.object?(this._predicate=i.predicate,this._object=i.object,this._getTripleEndReader()):this._readPredicate},_readDataTypeOrLang:function(e){switch(e.type){case"type":var t;if(""===e.prefix)t=e.value;else{var i=this._prefixes[e.prefix];if(i===d)return this._error('Undefined prefix "'+e.prefix+':"',e);t=i+e.value}return this._object+="^^<"+t+">",this._getTripleEndReader();case"langcode":return this._object+="@"+e.value.toLowerCase(),this._getTripleEndReader();default:return this._getTripleEndReader().call(this,e)}},_readListItem:function(e){var t=null,i=null,u=this._subject,s=this._tripleStack,r=s[s.length-1],n=this._readListItem;switch(e.type){case"explicituri":t=e.value;break;case"qname":if("_"===e.prefix)t=this._blankNodes[e.value]||(this._blankNodes[e.value]="_:b"+this._blankNodeCount++);else{var a=this._prefixes[e.prefix];if(a===d)return this._error('Undefined prefix "'+e.prefix+':"',e);t=a+e.value}break;case"literal":t=e.value,n=this._readDataTypeOrLang;break;case"bracketopen":i="_:b"+this._blankNodeCount++,t="_:b"+this._blankNodeCount++,s.push({subject:i,predicate:o,object:t,type:"blank"}),this._subject=t,n=this._readBlankNodeHead;break;case"liststart":i="_:b"+this._blankNodeCount++,s.push({subject:i,predicate:o,object:_,type:"list"}),this._subject=null,n=this._readListItem;break;case"listend":if(s.pop(),0!==s.length&&"list"===s[s.length-1].type&&this._callback(null,{subject:r.subject,predicate:r.predicate,object:r.object,context:"n3/contexts#default"}),this._subject=r.subject,null===r.predicate){if(n=this._readPredicate,r.subject===_)return n}else if(this._predicate=r.predicate,this._object=r.object,n=this._getTripleEndReader(),r.object===_)return n;i=_;break;default:return this._error('Expected list item instead of "'+e.type+'"',e)}return null===i&&(this._subject=i="_:b"+this._blankNodeCount++),null===u?r.object===_?r.object=i:r.subject=i:this._callback(null,{subject:u,predicate:h,object:i,context:"n3/contexts#default"}),null!==t&&this._callback(null,{subject:i,predicate:o,object:t,context:"n3/contexts#default"}),n},_readPunctuation:function(e,t){var i;switch(e.type){case"dot":i=this._readInTopContext;break;case"semicolon":i=this._readPredicate;break;case"comma":i=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object+'"',e)}return t||this._callback(null,{subject:this._subject,predicate:this._predicate,object:this._object,context:"n3/contexts#default"}),i},_readPrefix:function(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixURI)},_readPrefixURI:function(e){if("explicituri"!==e.type)return this._error('Expected explicituri to follow prefix "'+this.prefix+'"',e);var t;return t=null===this._baseURI||p.test(e.value)?e.value:(b.test(e.value)?this._baseURI:this._baseURIRoot)+e.value,this._prefixes[this._prefix]=t,this._readDeclarationPunctuation},_readBaseURI:function(e){return"explicituri"!==e.type?this._error("Expected explicituri to follow base declaration",e):(this._baseURI=null===this._baseURI||p.test(e.value)?e.value:(b.test(e.value)?this._baseURI:this._baseURIRoot)+e.value,this._baseURIRoot=this._baseURI.replace(x,""),this._readDeclarationPunctuation)},_readDeclarationPunctuation:function(e){return this._sparqlStyle?this._readInTopContext(e):"dot"!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext},_getTripleEndReader:function(){var e=this._tripleStack;if(0===e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem}},_error:function(e,t){this._callback(e+" at line "+t.line+".")},parse:function(e,t){var i=this;this._prefixes=Object.create(null),this._callback=t,this._readCallback=this._readInTopContext,this._lexer.tokenize(e,function(e,t){i._readCallback!==d&&(null!==e?i._callback(e):i._readCallback=i._readCallback(t))})}},e.N3={Parser:u,Lexer:t,Store:i}}(this);